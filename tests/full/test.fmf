summary: Run the full tmt test suite in an external system
description: |
    To check local changes without pushing to git:
      make test

    To run only tests which will not run in merge request:
      make test-complement

    Run under a local virtual machine:
      tmt run -vvv -e BRANCH=<tested branch>
    Run just tests not run in a merge request:
      tmt run -vvv -e BRANCH=<tested branch> -e SCOPE=complement

    Schedule a job using workflow-tomorrow:
      tmt test export --fmf-id | wow fedora-37 x86_64 --fmf-id - --taskparam=BRANCH=<branch>
    Again just test not run in a merge request
      tmt test export --fmf-id | wow fedora-37 x86_64 --fmf-id - --taskparam=SCOPE=complement --taskparam=BRANCH=<branch>

    Following environment variables can be used:

      COPY_IN - When '1' injects local content (produced by `make bundle`)
                and skips git clone (used to test local changes without push).

      REPO - URL to git repository to clone,
             defaults to github.com/teemtee/tmt

      BRANCH - Set to the branch, commit or tag to checkout,
               defaults to REPO's default branch

      KEEP_VERSION - When '1' tests keeps version and release
                     in the tmt.spec, otherwise set it to 9.9.9.9

      PLANS - Space separated names of plans to execute,
              when not set all enabled plans are run

      TESTS_CMD - String to be placed as after
                  `tests` subcommand (e.g. "-n /tests/unit")

      SCOPE - To run tests which do not run in CI set to 'complement',
              otherwise 'all' is used to run all tests


test: ./test.sh
framework: beakerlib
adjust:
- when: distro != fedora
  require+:
  - library(epel/epel)
require:
- rsync
- git-core
- rpm-build
- make
- procps-ng
- /usr/bin/virsh
recommend:
- guestfs-tools
- python3-docutils
duration: 4h
extra-hardware: |
  keyvalue=HVM=1
  hostrequire=memory >= 6144
  hostrequire=hypervisor=
